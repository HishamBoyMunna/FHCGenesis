<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Eco Dashboard | GreenTech Global</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
</head>
<body>
  <div class="leaves-background">
    <div>🍃</div>
    <div>🌿</div>
    <div>🍀</div>
    <div>🍂</div>
    <div>🍃</div>
    <div>🌿</div>
  </div>

  <div class="menu-panel" id="menuPanel">
    <h3>🌿 Eco Menu</h3>
    <ul>
      <li>🏠 Home</li><li>📦 Devices</li><li>📈 Analytics</li><li>⚙️ Settings</li>
      <li><a href="{{ url_for('logout') }}" style="color: inherit; text-decoration: none;">➡️ Logout</a></li>
    </ul>
  </div>
  <div class="overlay" id="menuOverlay"></div>

  <div class="dashboard">
    <header>
      <h1>🌍 Eco Buddy</h1>
      <div class="account-wrapper">
        <div class="account" id="accountBtn">👤 My Account</div>
        <div class="account-panel" id="accountPanel">
          <p><strong>Name:</strong> {{ fullname }}</p>
          <p><strong>Email:</strong> {{ email }}</p>
          <p><strong>Total Usage:</strong> - kWh</p>
        </div>
      </div>
      <button class="insights-btn" id="insightsBtn">💡 Get Insights</button>
    </header>
    

    <section class="devices-section">
      <h2>Connected Devices</h2>
      <ul id="device-list">
        <!-- <li data-electric="[10,12,15,13,14,16,18]" data-water="[5,6,7,6,6,7,8]">🌞 Solar Panel <button class="remove-btn">🗑️</button></li>
        <li data-electric="[7,8,9,10,9,8,10]" data-water="[20,25,22,23,24,26,27]">💧 Rainwater Tank <button class="remove-btn">🗑️</button></li>
        <li data-electric="[3,4,3,4,5,4,3]" data-water="[2,3,2,3,3,2,3]">🌬️ Air Quality Sensor <button class="remove-btn">🗑️</button></li> -->
      </ul>
      <button id="add-device-btn">➕ Add Device</button>
    </section>

    <section class="usage-charts">
      <div class="chart-box"><h3>Electricity Usage (kWh)</h3><canvas id="electricChart"></canvas></div>
      <div class="chart-box"><h3>Water Usage (L)</h3><canvas id="waterChart"></canvas></div>
      <div class="chart-box"><h3>Waste Production (Kg)</h3><canvas id="wasteChart"></canvas></div>
    </section>
  </div>

  <button class="ai-assistant" id="ai-btn">🤖</button>
  <div class="chat-box" id="chat-box">
    <div class="chat-header">
      <span>EcoBuddy</span>
      <span class="close-chat" id="closeChat">&times;</span>
    </div>
    <div class="chat-body" id="chat-body"><p><strong>Buddy:</strong> Hi! Need help with your usage?</p></div>
    <input class="chat-input" placeholder="Ask me something..." onkeydown="handleChat(event)" />
  </div>
  <button class="bottom-left-btn" id="menuToggle">🌿 Menu</button>

  <div class="overlay" id="deviceOverlay"></div>
  <div class="device-modal" id="deviceModal">
    <div class="device-modal-content">
      <span class="close-modal" id="closeDeviceModal">&times;</span>
      <h3>Add New Device</h3>
      <div class="form-group">
        <label for="resourceType">Monitor Resource:</label>
        <select id="resourceType">
          <option value="">--Select--</option>
          <option value="electric">Electricity</option>
          <option value="water">Water</option>
          <option value="waste">Waste</option>
        </select>
      </div>
      <div class="form-group">
        <label for="deviceName">Device Name:</label>
        <input type="text" id="deviceName" placeholder="e.g., Living Room Lights, Bathroom Tap" />
      </div>
      <div class="form-group">
        <label for="deviceRating">Device Rating:</label>
        <input type="number" id="deviceRating" min="0" step="0.1" placeholder="e.g., 0.5 for 500W fan" />
        <small id="ratingUnit">Unit will be set based on resource type</small>
      </div>
      <div class="modal-actions">
        <button id="cancelDeviceBtn">Cancel</button>
        <button id="saveDeviceBtn">Save Device</button>
      </div>
      </div>
    </div>
  </div>

  <!-- Usage Edit Modal -->
  <div class="overlay" id="usageOverlay"></div>
  <div class="usage-modal" id="usageModal">
    <div class="usage-modal-content">
      <span class="close-modal" id="closeUsageModal">&times;</span>
      <h3>Edit Usage Data</h3>
      <div class="device-info">
        <p><strong>Device:</strong> <span id="editDeviceName"></span></p>
        <p><strong>Type:</strong> <span id="editDeviceType"></span></p>
        <p><strong>Rating:</strong> <span id="editDeviceRating"></span></p>
        <p><strong>Unit:</strong> <span id="editDeviceUnit"></span></p>
      </div>
      <div class="usage-form">
        <h4>Daily Usage (Last 7 Days)</h4>
        <div class="usage-inputs">
          <div class="usage-day">
            <label for="usage-date">Date:</label>
            <input type="date" id="usage-date" />
          </div>
          <div class="usage-day">
            <label for="usage-hours">Hours Used:</label>
            <input type="number" id="usage-hours" min="0" step="0.1" placeholder="e.g., 2.5" />
          </div>
        </div>
        <div class="usage-history">
          <h5>Recent Usage History</h5>
          <div id="usageHistory"></div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="cancelUsageBtn">Cancel</button>
        <button id="saveUsageBtn">Save Usage</button>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
  
  <footer class="main-footer">
    <div class="footer-content">
      <div class="footer-section about">
        <h3>About EcoBuddy Global</h3>
        <p>Your partner in sustainable living. We provide innovative solutions to monitor and reduce your environmental footprint, empowering you to make a difference.</p>
      </div>
      <div class="footer-section links">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="#">Home</a></li>
          <li><a href="#">Devices</a></li>
          <li><a href="#">Analytics</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Terms of Service</a></li>
        </ul>
      </div>
      <div class="footer-section contact">
        <h3>Contact Us</h3>
        <p><i class="fa fa-envelope"></i> info@ecobuddy.com</p>
        <p><i class="fa fa-phone"></i> +91 98765 -----</p>
        <p><i class="fa fa-map-marker"></i> Angamaly, Kerala, India</p>
      </div>
    </div>
    <div class="footer-bottom">
      &copy; <span id="current-year"></span> EcoBuddy Global. All rights reserved.
    </div>
  </footer>
</body>
</html>